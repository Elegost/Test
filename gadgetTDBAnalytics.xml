<?xml version="1.0" encoding="UTF-8" ?>
<Module>
   <ModulePrefs title="Gadget TDB Analytics"
                description="Gadget permettant d'afficher des graphiques en fonction d'un fichier Spreadsheet"
                width="750" 
                author="EL3GOST">
          <Require feature="dynamic-height"/>
  </ModulePrefs>
  <UserPref name="idSite" display_name="Identifiant du site" default_value="modele" />
   <Content type="html"><![CDATA[

  <div id='dest'><img src="http://www.google.com/ig/images/spinner.gif"></div>


 <script type="text/javascript">
   var prefs = new _IG_Prefs();
   var idSitePref = prefs.getString("idSite");
   var urlGadget = "https://script.google.com/a/cci-paris-idf.fr/macros/s/AKfycbwOz7qwg_do40Cl6pPpZH7sgIehpxn_tAIgA_ozd4C1qH39M2ZW/exec";

 gadgets.util.registerOnLoadHandler(doRender);

  function doRender(){
    // setup variables
    var prefs = new gadgets.Prefs();
    var iframeURL = urlGadget + "?idSite=" + idSitePref;
    var height = 800;
    var width = 600;

    if (gadgets.window) {
      var viewport = gadgets.window.getViewportDimensions();
      if (viewport.width) {
        var width = viewport.width;
      }
      if (viewport.height) {
        var height = viewport.height;
      }
    }

    var iframe = document.createElement('iframe');
    iframe.setAttribute('width', width + 'px');
    iframe.setAttribute('height', height + 'px');
    iframe.setAttribute('frameborder','no');
    iframe.setAttribute('src', iframeURL);

    // set the slideshow to the placeholder div
    var dest = document.getElementById('dest');
    dest.innerHTML = '';
    dest.appendChild(iframe);
  }

</script>

   ]]>
  </Content>
</Module>
